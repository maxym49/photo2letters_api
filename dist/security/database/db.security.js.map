{"version":3,"sources":["../../../src/security/database/db.security.js"],"names":["decryptToken","data","fs","readFileSync","path","join","__dirname","jsonFile","JSON","parse","et","EncryptionTool","decrypt","token","encryptToken","encrypt"],"mappings":";;;;;;;AAAA;;AACA;;AACA;;;;AAEA,IAAMA,YAAY,GAAG,SAAfA,YAAe,GAAM;AACzB,MAAMC,IAAI,GAAGC,eAAGC,YAAH,CACXC,iBAAKC,IAAL,CAAUC,SAAV,EAAqB,gCAArB,EAAuD,YAAvD,CADW,CAAb;;AAGA,MAAMC,QAAQ,GAAGC,IAAI,CAACC,KAAL,CAAWR,IAAX,CAAjB;AACA,MAAMS,EAAE,GAAG,IAAIC,0BAAJ,EAAX;AACA,SAAOD,EAAE,CAACE,OAAH,CAAWL,QAAQ,CAACM,KAApB,CAAP;AACD,CAPD;;;;AASA,IAAMC,YAAY,GAAG,SAAfA,YAAe,CAAAD,KAAK,EAAI;AAC5B,MAAMH,EAAE,GAAG,IAAIC,0BAAJ,EAAX;AACA,SAAOD,EAAE,CAACK,OAAH,CAAWF,KAAX,CAAP;AACD,CAHD","sourcesContent":["import fs from 'fs';\r\nimport path from 'path';\r\nimport EncryptionTool from '../encryption-tool/encryptionTool';\r\n\r\nconst decryptToken = () => {\r\n  const data = fs.readFileSync(\r\n    path.join(__dirname, '../../../tokens/database-token', 'token.json')\r\n  );\r\n  const jsonFile = JSON.parse(data);\r\n  const et = new EncryptionTool();\r\n  return et.decrypt(jsonFile.token);\r\n};\r\n\r\nconst encryptToken = token => {\r\n  const et = new EncryptionTool();\r\n  return et.encrypt(token);\r\n};\r\n\r\nexport { decryptToken, encryptToken };\r\n"],"file":"db.security.js"}